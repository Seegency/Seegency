function scriptLoader(){this.load=(e,t)=>(Array.isArray(e)||(e=[e]),Promise.all(e.map((e=>((e,t)=>new Promise(((o,n)=>{const l=window.document.createElement("script");l.src=e,l.async=!0,l.crossOrigin="anonymous",t=t||{};for(const e in t)l[e]=t[e];l.addEventListener("load",(()=>{o(l)}),!1),l.addEventListener("error",(()=>{n(l)}),!1),window.document.body.appendChild(l)})))(e,t))))),this.loadChain=function(e){const t=Array.isArray(arguments)?arguments:Array.prototype.slice.call(arguments),o=this.require(t.shift()),n=this;return t.length?o.then((()=>{n.requireChain(...t)})):o}}function debounce(e,t,o){var n;return function(){var l=this,r=arguments,c=o&&!n;clearTimeout(n),n=setTimeout((function(){n=null,o||e.apply(l,r)}),t||500),c&&e.apply(l,r)}}var colyFirstTimeUrl=document.URL;function colyInit(){colyReloadFieldVisibility(),colyForm();const e=document.querySelector("coly-app");if(e){const t=e.querySelectorAll("input");for(const e of t)e.addEventListener("keyup",debounce((function(){colyValidateForm()}),300));const o=e.querySelectorAll("select");for(const e of o)e.addEventListener("change",debounce((function(){colyValidateForm()}),300));const n=e.querySelectorAll("textarea");for(const e of n)e.addEventListener("keyup",debounce((function(){colyValidateForm()}),300));const l=e.querySelectorAll('input[type="checkbox"]');for(const e of l)e.addEventListener("change",debounce((function(){colyValidateForm()}),300));const r=e.querySelectorAll('input[type="radio"]');for(const e of r)e.addEventListener("change",debounce((function(){colyValidateForm()}),300))}}function colyReloadFieldVisibility(){var e=document.URL,t=new URL(e).searchParams.get("variant");null==t&&(t=window.coly_default_variant_id);const o=document.querySelectorAll(".variant-placeholder");for(const e of o)e.classList.contains(`variant-id-${t}`)?"1"==e.getAttribute("data-hidden-by-default")?(e.style.display="none",e.classList.add("coly-hidden")):(e.style.display="block",e.classList.remove("coly-hidden")):(e.style.display="none",e.classList.add("coly-hidden"));window.colyLogicMethodSignature&&window[window.colyLogicMethodSignature]()}function colyBuyButtons(e){var t=document.querySelectorAll('form[action*="/cart/add"]');0==t.length&&(t=document.querySelectorAll('form[id*="add-to-cart-form"]')),0==t.length&&(t=document.querySelectorAll('form[data-type="add-to-cart-form"]'));for(const n of t){var o=n.querySelector('button[type="submit"]');o||(o=n.querySelector('[data-action="add-to-cart"]')),o||(o=n.querySelector("#addtocart")),o||(o=n.querySelector("#addToCart")),o||(o=n.querySelector("#AddToCart")),o||(o=n.querySelector('[name="add"]')),o||(o=n.querySelector("[data-add-to-cart]")),o||(o=n.querySelector("[data-add-to-cart-text]")),o&&"enable"==e&&o.removeAttribute("disabled"),o&&"disable"==e&&o.setAttribute("disabled","disabled")}}function colyForm(){var e=document.querySelectorAll('form[action*="/cart/add"]');0==e.length&&(e=document.querySelectorAll('form[id*="add-to-cart-form"]')),0==e.length&&(e=document.querySelectorAll('form[data-type="add-to-cart-form"]'));for(const t of e){const e=document.querySelector("coly-app"),o=e.querySelectorAll("input");for(const e of o)e.addEventListener("change",(function(e){const o=e.target.name,n=e.target.value,l=t.querySelector(`input[name="${o}"]`),r=e.target.getAttribute("data-coly-order");if(l)l.value=n;else{const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",o),e.setAttribute("value",n),e.setAttribute("data-coly-order",r),t.insertBefore(e,t.querySelector("div"))}}));const n=e.querySelectorAll("select");for(const e of n)e.addEventListener("change",(function(e){const o=e.target.name,n=e.target.value,l=t.querySelector(`input[name="${o}"]`),r=e.target.getAttribute("data-coly-order");if(l)l.value=n;else{const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",o),e.setAttribute("value",n),e.setAttribute("data-coly-order",r),t.insertBefore(e,t.querySelector("div"))}}));const l=e.querySelectorAll('input[type="radio"]');for(const e of l)e.addEventListener("change",(function(e){const o=e.target.name,n=e.target.value,l=t.querySelector(`input[name="${o}"]`),r=e.target.getAttribute("data-coly-order");if(l)l.value=n;else{const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",o),e.setAttribute("value",n),e.setAttribute("data-coly-order",r),t.insertBefore(e,t.querySelector("div"))}}));const r=e.querySelectorAll('input[type="checkbox"]');for(const o of r)o.addEventListener("change",(function(o){const n=o.target.name,l=(o.target.value,e.querySelectorAll(`input[name="${n}"]:checked`));let r="";for(const e of l)r=""===r?e.value:r+", "+e.value;const c=t.querySelector(`input[name="${n}"]`),i=o.target.getAttribute("data-coly-order");if(c)c.value=r;else{const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",n),e.setAttribute("value",r),e.setAttribute("data-coly-order",i),t.insertBefore(e,t.querySelector("div"))}}));const c=e.querySelectorAll("textarea");for(const e of c)e.addEventListener("change",(function(e){const o=e.target.name,n=e.target.value,l=t.querySelector(`input[name="${o}"]`),r=e.target.getAttribute("data-coly-order");if(l)l.value=n;else{const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",o),e.setAttribute("value",n),e.setAttribute("data-coly-order",r),t.insertBefore(e,t.querySelector("div"))}}))}}function colyValidateForm(){colyValidation()?colyBuyButtons("enable"):colyBuyButtons("disable")}function colyHasMandatoryFields(){const e=document.querySelector("coly-app");if(e){if(e.querySelectorAll(".coly-block:not(.coly-hidden) [required]").length>0)return!0}return!1}function colyValidation(e=null){let t=!0;const o=document.querySelectorAll('[data-app-name="coly"] .coly-block:not(.coly-hidden)');for(const n of o){let o="";const l=n.querySelector('[type="email"]');if(l){const e=l.value;e.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||""===e||(o="This field is not a valid email")}const r=n.querySelector('[type="number"]');if(r){const e=1*r.getAttribute("min"),t=1*r.getAttribute("max"),n=r.getAttribute("step"),l=r.value;if(l&&(1*l<e||1*l>t)&&(o="This field is not within the valid range"),l&&n&&""==o){let e=n.split("."),t=l.split(".");e=e.length>1?e[1].length:0,t=t.length>1?t[1].length:0,t>e&&(o="This field decimal places is not valid")}}const c=n.querySelector('[type="url"]');if(c){const e=c.value;e.match(/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/)||""===e||(o="This field is not a valid URL")}const i=n.querySelector('[data-inputmask*="99/99/9999"]');if(i){const e=i.value.split("/"),t=e[0],n=e[1],l=e[2],r=new Date(l,n-1,t);r.getFullYear()==l&&r.getMonth()+1==n&&r.getDate()==t||(o="This field is not a valid date. Please use the format DD/MM/YYYY")}const a=n.querySelector("[minlength]"),d=n.querySelector("[maxlength]");a&&a.value.length<a.minLength&&(o=`This field must be at least ${a.minLength} characters`),d&&d.value.length>d.maxLength&&(o=`This field must be at most ${d.maxLength} characters`);const u=n.querySelector("[required]");if(u)if("checkbox"===u.type||"radio"===u.type){const e=n.querySelectorAll(`input[name="${u.name}"]`);let t=!1;for(const o of e)o.checked&&(t=!0);t||(o="This field is required")}else u.value.length<1&&(o="This field is required");""!=o?(null!=e&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),o='<svg class="coly-error-icon" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path clip-rule="evenodd" fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z"></path></svg>'+o,n.querySelector(".coly-error").innerHTML=o,t=!1):n.querySelector(".coly-error")&&(n.querySelector(".coly-error").innerHTML="")}if(t){colyResetProperties();const e=document.querySelectorAll('input[type="hidden"][data-coly-order]'),t=Array.from(e);t.sort((function(e,t){return e.getAttribute("data-coly-order")-t.getAttribute("data-coly-order")}));for(const e of t){const t=e.parentNode;t.removeChild(e),t.appendChild(e)}}return t}document.addEventListener("change",(function(e){var t=document.URL,o=new URL(t).searchParams.get("variant");e.target.name.includes("properties[")||o&&colyFirstTimeUrl!=t&&(colyInit(),setTimeout((function(){colyValidateForm()}),1e3))})),window.addEventListener("load",(function(){let e=document.querySelectorAll("coly-app input[data-inputmask]");if(e.length>0){(new scriptLoader).load(["https://cdn.jsdelivr.net/npm/inputmask@5.0.8/dist/inputmask.min.js"]).then((({length:t})=>{Inputmask().mask(e)}))}})),document.addEventListener("DOMContentLoaded",(function(){colyInit(),colyHasMandatoryFields()&&colyBuyButtons("disable")}));const colyWindowFetch=window.fetch;function colyFormLogic(e,t){e&&e.forEach(((e,o)=>{let n=document.getElementById(e.if_field_1),l=e.condition_operator_1,r=e.condition_value_1,c=null,i=null,a=null,d=null,u=null,s=null;e.if_field_2&&(c=document.getElementById(e.if_field_2),i=e.condition_operator_2,a=e.condition_value_2),e.if_field_3&&(d=document.getElementById(e.if_field_3),u=e.condition_operator_3,s=e.condition_value_3);let y=!1,f=!0;if(n&&(y=!0,f="none"!=n.closest(".coly-block").style.display&&(f&&colyCompare(colyGetFieldValue(n),r,l))),c&&(y=!0,f="none"!=c.closest(".coly-block").style.display&&(f&&colyCompare(colyGetFieldValue(c),a,i))),d&&(y=!0,f="none"!=d.closest(".coly-block").style.display&&(f&&colyCompare(colyGetFieldValue(d),s,u))),f&&y)for(let o=1;o<=3;o++){let n=null,l=null,r=null;if(e["then_field_"+o]&&(n=e["then_field_"+o],l=t.find((e=>e.id==n)),r=e["then_action_"+o]),l)if("show"==r){let e=document.getElementById(l.id);e.closest(".coly-block").style.display="block",e.closest(".coly-block").classList.remove("coly-hidden")}else{let e=document.getElementById(l.id);e.closest(".coly-block").style.display="none",e.closest(".coly-block").classList.add("coly-hidden")}}if(!f&&y)for(let o=1;o<=3;o++){let n=null,l=null;if(e["then_field_"+o]&&(n=e["then_field_"+o],l=t.find((e=>e.id==n))),l){let e=document.getElementById(l.id);e.closest(".coly-block").style.display=l.hide_by_default?"none":"block",l.hide_by_default?e.closest(".coly-block").classList.add("coly-hidden"):e.closest(".coly-block").classList.remove("coly-hidden")}}}))}function colyGetFieldValue(e){if("radio"==e.type){let t=document.querySelector('input[id="'+e.id+'"]:checked');return t?t.value:""}if("checkbox"==e.type){let t=document.querySelector('input[id="'+e.id+'"]:checked');return t?t.value:""}return"select-one"==e.type?e.options[e.selectedIndex].value:e.value}function colyCompare(e,t,o){return"=="==o?e==t:"!="==o?e!=t:">="==o?e>=t:"<="==o?e<=t:">"==o?e>t:"<"==o&&e<t}function colyResetProperties(){var e=document.querySelectorAll('form[action*="/cart/add"]');0==e.length&&(e=document.querySelectorAll('form[id*="add-to-cart-form"]')),0==e.length&&(e=document.querySelectorAll('form[data-type="add-to-cart-form"]'));for(const t of e){const e=document.querySelector("coly-app"),o=e.querySelectorAll("input");for(const e of o)if(e.closest(".coly-hidden")){const o=t.querySelector(`input[type="hidden"][name="${e.name}"]`);o&&(o.value="")}const n=e.querySelectorAll("select");for(const e of n)if(e.closest(".coly-hidden")){const o=t.querySelector(`input[type="hidden"][name="${e.name}"]`);o&&(o.value="")}const l=e.querySelectorAll('input[type="radio"]');for(const e of l)if(e.closest(".coly-hidden")){const o=t.querySelector(`input[type="hidden"][name="${e.name}"]`);o&&(o.value="")}const r=e.querySelectorAll('input[type="checkbox"]');for(const e of r)if(e.closest(".coly-hidden")){const o=t.querySelector(`input[type="hidden"][name="${e.name}"]`);o&&(o.value="")}const c=e.querySelectorAll("textarea");for(const e of c)if(e.closest(".coly-hidden")){const o=t.querySelector(`input[type="hidden"][name="${e.name}"]`);o&&(o.value="")}}}window.fetch=async function(...e){var t=e[0];return t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?"))),t.includes("/cart/add")&&!colyValidation()?new Response(JSON.stringify({status:!0,description:"There are errors in the form. Please check and try again."}),{status:422,headers:{"Content-type":"application/json"}}):colyWindowFetch.apply(window,e)};
